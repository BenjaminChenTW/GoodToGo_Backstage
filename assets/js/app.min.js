function initPage(){return window.location.hash||"#index"}function durationToString(t){var e=0,o="",n=function(t,n){o+=(2===++e?" ":"")+t+" "+n};return 0!==t.get("Y")&&n(t.get("Y"),"年"),0!==t.get("M")&&n(t.get("M"),"個月"),2==e?o:(0!==t.get("d")&&n(t.get("d"),"天"),2==e?o:(0!==t.get("h")&&n(t.get("h"),"小時"),2==e||(0!==t.get("m")&&n(t.get("m"),"分鐘"),""===o&&(o+="0")),o))}function appInit(t){var o=!1,a=null,i=initPage().replace("#",""),n=function(t,n){switch(n){case"withArrow":return"("+(0<=t?'<i class="material-icons" role="presentation">arrow_upward</i>':'<i class="material-icons" role="presentation">arrow_downward</i>')+parseFloat(100*Math.abs(t)).toFixed(1)+"%)";case"withoutParentheses":return parseFloat(100*t).toFixed(1)+"%";default:return"("+parseFloat(100*t).toFixed(1)+"%)"}},e=new Vue({el:"#app",mounted:function(){this[i].show=!0},filters:{numberWithCommas:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},numberToPercentage:n,durationToString:function(t){return durationToString(moment.duration(t))},dateToString:function(t,n){switch(n){case"only_date":return moment(t).format("YYYY-MM-DD");case"with_day":return moment(t).format("YYYY-MM-DD (ddd) HH:mm");default:return moment(t).format("YYYY-MM-DD HH:mm")}}},updated:function(){o&&(componentHandler.upgradeDom(),o=!1),this.dynamicLoading.rawCapacity=rawCapacityCount(i+(this.detailIsOpen?"-detail":""))},methods:{navClickListener:function(n){var e=this;i+"Detail"in this&&(this[i+"Detail"].show=!1),$(".mdl-layout__obfuscator.is-visible").click(),requestData(n,function(t){e[i].show=!1,e[n].show=!0,test||(e[n].data=t),e.dynamicLoading.baseIndex=1,i=n,o=!0,$("main").scrollTop(0)})},aRecordClickListener:function(t,n){var e=this,o=(a=t+"Detail")+"?id="+this[t].data.list[n].id;requestData(o,function(t){e[a].show=!0,test||(e[a].data=t),e.dynamicLoading.baseIndex=1,$("main").scrollTop(0)})},closeDetail:function(){this[a||i+"Detail"].show=!1,this[a||i+"Detail"].data.history=[],this.dynamicLoading.baseIndex=1},flipPage:function(t){var n;n=this.detailIsOpen?this[i+"Detail"].data.history.length:this[i].data.list.length;var e=Math.ceil(n/this.dynamicLoading.rawCapacity);switch(t){case"next":this.dynamicLoading.baseIndex=Math.min(this.dynamicLoading.baseIndex+1,e);break;case"last":this.dynamicLoading.baseIndex=Math.max(this.dynamicLoading.baseIndex-1,1)}},numberToPercentage:n},computed:{detailIsOpen:function(){return this.shopDetail.show||this.userDetail.show||this.containerDetail.show||this.deliveryDetail.show}},data:{loading:{show:!1,txt:"載入中..."},dynamicLoading:{baseIndex:1,rawCapacity:0},index:{show:!1,data:{summary:{userAmount:824,storeAmount:18,activityAmount:62},activityHistorySummary:{usedAmount:16774,lostAmount:135,totalDuration:12314},shopHistorySummary:{usedAmount:6487,lostAmount:248,totalDuration:57563433659,quantityOfBorrowingFromDiffPlace:796},shopRecentHistorySummary:{usedAmount:87,lostAmount:3,totalDuration:111013967,quantityOfBorrowingFromDiffPlace:23}}},search:{show:!1},shop:{show:!1,data:{list:[{id:0,storeName:"布萊恩紅茶",toUsedAmount:24,todayAmount:2,weekAmount:18,weekAverage:10}]}},shopDetail:{show:!1,expand:!1,data:{storeName:"布萊恩紅茶",toUsedAmount:24,todayAmount:2,weekAmount:18,recentAmount:18,joinedDate:1234,contactNickname:"店長",contactPhone:"0988555666",recentAmountPercentage:.16,weekAverage:10,history:[{time:1234,serial:"#161",action:"借出",owner:"0911-***-521",by:"布萊恩紅茶(阿呆店長)"}]}},activity:{show:!1},user:{show:!1,data:{totalUserAmount:2500,totalUsageAmount:2500,weeklyAverageUsage:2500,totalLostAmount:12,list:[{id:0,phone:"0912345678",usingAmount:25,lostAmount:1,totalUsageAmount:30}]}},userDetail:{show:!1,expand:!1,data:{userPhone:"0936-003-091",usingAmount:3,lostAmount:23,totalUsageAmount:200,joinedDate:1234,joinedMethod:"店鋪 (方糖咖啡)",recentAmount:18,recentAmountPercentage:.16,weekAverage:10,averageUsingDuration:2e4,percentageOfBorrowingFromDiffPlace:.43,history:[{containerType:"12oz 玻璃杯",containerID:"#101",rentTime:1234,rentPlace:"布萊恩紅茶",returnTime:1234,returnPlace:"布萊恩紅茶",usingDuration:1234}]}},container:{show:!1,data:{list:[{id:0,type:"16oz 玻璃杯",totalAmount:286,toUsedAmount:106,usingAmount:20,returnedAmount:19,toCleanAmount:41,toDeliveryAmount:24,toSignAmount:0,inStorageAmount:15,lostAmount:161},{id:1,type:"12oz 玻璃杯",totalAmount:393,toUsedAmount:50,usingAmount:23,returnedAmount:17,toCleanAmount:22,toDeliveryAmount:0,toSignAmount:0,inStorageAmount:111,lostAmount:170},{id:2,type:"16oz 把手杯",totalAmount:56,toUsedAmount:1,usingAmount:0,returnedAmount:0,toCleanAmount:2,toDeliveryAmount:0,toSignAmount:0,inStorageAmount:49,lostAmount:4}]}},containerDetail:{show:!1,expand:!1,data:{containerID:"#257",containerType:{txt:"16oz 玻璃杯",code:1},reuseTime:24,status:"使用中",bindedUser:"0921-**-931",joinedDate:1234,history:[{tradeTime:1234,action:"借出",newUser:"0921-***-931",oriUser:"特有種商行(小衛)",comment:""}]}},delivery:{show:!1},deliveryDetail:{show:!1,expand:!1}}});(t.app=e).navClickListener(i)}function rawCapacityCount(t){var n=$("#"+t).find("tbody").get(0);if(n){var e=n.getBoundingClientRect(),o="user-detail"!==t?48:56,a=Math.floor((window.innerHeight-e.top-28)/o);return 5<a?a:5}}!function(e){var a=null;function o(t,o){a&&a.abort(),i();var n="/manager/data/"+t;console.log(n),a=$.ajax(n,{headers:{Accept:"application/json; charset=utf-8"},dataType:"json"}).done(function(t,n,e){r(),o(t)}).fail(function(t,n,e){var o;r(),"abort"!==t.statusText&&(o="["+t.status+"]: "+(t.responseJSON?t.responseJSON.message:t.statusText||"Unknown ERR"),document.querySelector("#toast").MaterialSnackbar.showSnackbar({message:o,timeout:4e3}))}).always(function(){a=null})}function i(){app.loading.txt="Loading...",app.loading.show=!0}function r(){app.loading.show=!1,app.loading.txt=""}e.test=!1,e.requestData=function(t,n){return e.test?function(t,n){a&&clearTimeout(a),i();var e="/manager/data/"+t;console.log(e),a=setTimeout(function(){a=null,r(),n()},500)}(t,n):o(t,n)}}(window),$(window).on("load",function(){"/manager/login"!==window.location.pathname&&($("#loading_main").css("display","none"),appInit(window))});
//# sourceMappingURL=source-maps/app.min.js.map
