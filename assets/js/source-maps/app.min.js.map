{"version":3,"sources":["main.js","api.js"],"names":["appInit","window","needUpdate","showedDetail","nowActiveSection","location","hash","replace","$","get","index","tmpDynamicLoadingBaseIndex","placeholderTxtDict","shop","user","container","numberToPercentage","number","option","isNaN","parseFloat","Math","abs","toFixed","dataFilter","aData","app","searchRegExp","id","match","storeName","cleanSearchBar","val","parent","removeClass","blur","search","txt","Vue","el","mounted","this","show","filters","numberWithCommas","toString","durationToString","millisecond","duration","moment","result","addString","num","ctr","dateToString","date","mode","thisMoment","isValid","format","updated","componentHandler","upgradeDom","dynamicLoading","rawCapacity","realActiveSection","table","find","table_box","getBoundingClientRect","rawHeight","floor","innerHeight","top","rawCapacityCount","detailIsOpen","methods","navClickListener","destination","localApp","click","requestData","data","test","baseIndex","placeholder","scrollTop","aRecordClickListener","from","detailToShow","toRequest","closeDetail","history","flipPage","to","dataLength","length","list","maxIndex","ceil","min","max","searchData","aSearchResultClickListener","category","daemon","listMatchCtx","computed","shopDetail","userDetail","containerDetail","deliveryDetail","txtArr","split","filter","ele","forEach","arr","join","regExpTxt","RegExp","error","shopList","userList","loading","summary","userAmount","storeAmount","activityAmount","activityHistorySummary","usedAmount","lostAmount","totalDuration","shopHistorySummary","quantityOfBorrowingFromDiffPlace","shopRecentHistorySummary","name","type","delivery","toUsedAmount","todayAmount","weekAmount","weekAverage","expand","recentAmount","joinedDate","contactNickname","contactPhone","recentAmountPercentage","time","serial","action","owner","by","activity","totalUserAmount","totalUsageAmount","weeklyAverageUsage","totalLostAmount","phone","usingAmount","userPhone","joinedMethod","averageUsingDuration","amountOfBorrowingFromDiffPlace","containerType","containerID","rentTime","rentPlace","returnTime","returnPlace","usingDuration","totalAmount","returnedAmount","toCleanAmount","toDeliveryAmount","toSignAmount","inStorageAmount","code","reuseTime","status","bindedUser","tradeTime","newUser","oriUser","comment","pendingReq","page","cb","abort","startLoading","requestUrl","console","log","ajax","headers","Accept","dataType","done","textStatus","jqXHR","stopLoading","fail","errorThrown","errMsg","statusText","responseJSON","href","attr","message","document","querySelector","MaterialSnackbar","showSnackbar","timeout","always","clearTimeout","setTimeout","requestDataDemo","on","pathname","css"],"mappings":"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","file":"../app.min.js","sourcesContent":["$(window).on('load', function() {\r\n    if (window.location.pathname !== \"/manager/login\") {\r\n        $('#loading_main').css('display', 'none');\r\n        appInit(window);\r\n    }\r\n});\r\n\r\nfunction appInit(window) {\r\n    var needUpdate = false;\r\n    var showedDetail = null;\r\n    var nowActiveSection = (window.location.hash || \"#index\").replace(\"#\", \"\");\r\n    if (!$(\"#\" + nowActiveSection).get(0)) nowActiveSection = index;\r\n    var tmpDynamicLoadingBaseIndex = null;\r\n    var placeholderTxtDict = {\r\n        shop: \"店鋪\",\r\n        user: \"使用者\",\r\n        container: \"容器\"\r\n    };\r\n    var arrowUpward = '<i class=\"material-icons\" role=\"presentation\">arrow_upward</i>';\r\n    var arrowDownward = '<i class=\"material-icons\" role=\"presentation\">arrow_downward</i>';\r\n    var arrowDropDown = '<i class=\"material-icons\" role=\"presentation\">arrow_drop_down</i>';\r\n    var numberToPercentage = function(number, option) {\r\n        if (isNaN(number)) number = 0;\r\n        switch (option) {\r\n            case 'withArrow':\r\n                var arrow = number >= 0 ? arrowUpward : arrowDownward;\r\n                return \"(\" + arrow + parseFloat(Math.abs(number) * 100).toFixed(1) + \"%)\";\r\n            case 'withoutParentheses':\r\n                return parseFloat(number * 100).toFixed(1) + \"%\";\r\n            default:\r\n                return \"(\" + parseFloat(number * 100).toFixed(1) + \"%)\";\r\n        }\r\n    };\r\n    var rawCapacityCount = function(realActiveSection) {\r\n        var table = $(\"#\" + realActiveSection).find('tbody').get(0);\r\n        if (!table) return;\r\n        var table_box = table.getBoundingClientRect();\r\n        var rawHeight = (realActiveSection !== \"user-detail\" ? 48 : 65);\r\n        var rawCapacity = Math.floor((window.innerHeight - table_box.top - 36) / rawHeight);\r\n        return rawCapacity > 5 ? rawCapacity : 5;\r\n    };\r\n    var dataFilter = function(aData) {\r\n        if (app.searchRegExp) {\r\n            if (nowActiveSection === \"user\")\r\n                return aData.id.match(app.searchRegExp);\r\n            else if (nowActiveSection === \"shop\")\r\n                return aData.storeName.match(app.searchRegExp);\r\n        } else {\r\n            return aData;\r\n        }\r\n    };\r\n    var cleanSearchBar = function() {\r\n        $('.searchbar-field .mdl-textfield__input').val('').parent().removeClass('is-focused').removeClass('is-dirty').blur();\r\n        app.search.txt = \"\";\r\n    };\r\n    var durationToString = function(duration) {\r\n        var ctr = 0;\r\n        var result = \"\";\r\n        var addString = function(num, txt) {\r\n            ctr++;\r\n            result += (ctr === 2 ? \" \" : \"\") + num + \" \" + txt;\r\n        };\r\n        if (duration.get(\"Y\") !== 0) {\r\n            addString(duration.get(\"Y\"), \"年\");\r\n        }\r\n        if (duration.get(\"M\") !== 0) {\r\n            addString(duration.get(\"M\"), \"個月\");\r\n        }\r\n        if (ctr == 2) return result;\r\n        if (duration.get(\"d\") !== 0) {\r\n            addString(duration.get(\"d\"), \"天\");\r\n        }\r\n        if (ctr == 2) return result;\r\n        if (duration.get(\"h\") !== 0) {\r\n            addString(duration.get(\"h\"), \"小時\");\r\n        }\r\n        if (ctr == 2) return result;\r\n        if (duration.get(\"m\") !== 0) {\r\n            addString(duration.get(\"m\"), \"分鐘\");\r\n        }\r\n        if (result === \"\") result += \"0\";\r\n        return result;\r\n    };\r\n    var app = new Vue({\r\n        el: \"#app\",\r\n        mounted: function() {\r\n            this[nowActiveSection].show = true;\r\n        },\r\n        filters: {\r\n            numberWithCommas: function(number) {\r\n                return number.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\r\n            },\r\n            numberToPercentage: numberToPercentage,\r\n            durationToString: function(millisecond) {\r\n                if (isNaN(millisecond)) return millisecond;\r\n                return durationToString(moment.duration(millisecond));\r\n            },\r\n            dateToString: function(date, mode) {\r\n                if (date === \"尚未歸還\") return date;\r\n                var thisMoment = moment(date);\r\n                if (!thisMoment.isValid()) return date;\r\n                switch (mode) {\r\n                    case \"only_date\":\r\n                        return thisMoment.format(\"YYYY-MM-DD\");\r\n                    case \"with_day\":\r\n                        return thisMoment.format(\"YYYY-MM-DD (ddd) HH:mm\");\r\n                    default:\r\n                        return thisMoment.format(\"YYYY-MM-DD HH:mm\");\r\n                }\r\n            }\r\n        },\r\n        updated: function() {\r\n            if (needUpdate) {\r\n                componentHandler.upgradeDom();\r\n                needUpdate = false;\r\n            }\r\n            this.dynamicLoading.rawCapacity = rawCapacityCount(nowActiveSection + (this.detailIsOpen ? \"-detail\" : \"\"));\r\n        },\r\n        methods: {\r\n            navClickListener: function(destination) {\r\n                var localApp = this;\r\n                if (showedDetail || (nowActiveSection + \"Detail\") in this) this[showedDetail || (nowActiveSection + \"Detail\")].show = false;\r\n                cleanSearchBar();\r\n                $('.mdl-layout__obfuscator.is-visible').click();\r\n                requestData(destination, function(data) {\r\n                    localApp[nowActiveSection].show = false;\r\n                    localApp[destination].show = true;\r\n                    if (!test) localApp[destination].data = data;\r\n                    tmpDynamicLoadingBaseIndex = null;\r\n                    localApp.dynamicLoading.baseIndex = 1;\r\n                    nowActiveSection = destination;\r\n                    needUpdate = true;\r\n                    localApp.search.placeholder = (placeholderTxtDict[nowActiveSection] ? \"在「\" + placeholderTxtDict[nowActiveSection] + \"」中搜尋\" : \"搜尋\");\r\n                    $('main').scrollTop(0);\r\n                });\r\n            },\r\n            aRecordClickListener: function(from, index) {\r\n                var localApp = this;\r\n                var detailToShow = from + \"Detail\";\r\n                var toRequest = detailToShow + \"?id=\" + this[from + \"List\"][index].id;\r\n                requestData(toRequest, function(data) {\r\n                    if (showedDetail) localApp[showedDetail].show = false;\r\n                    localApp[detailToShow].show = true;\r\n                    showedDetail = detailToShow;\r\n                    if (!test) localApp[showedDetail].data = data;\r\n                    tmpDynamicLoadingBaseIndex = localApp.dynamicLoading.baseIndex;\r\n                    localApp.dynamicLoading.baseIndex = 1;\r\n                    cleanSearchBar();\r\n                    $('main').scrollTop(0);\r\n                });\r\n            },\r\n            closeDetail: function() {\r\n                cleanSearchBar();\r\n                this[showedDetail || (nowActiveSection + \"Detail\")].show = false;\r\n                this[showedDetail || (nowActiveSection + \"Detail\")].data.history = [];\r\n                showedDetail = null;\r\n                this.dynamicLoading.baseIndex = tmpDynamicLoadingBaseIndex || 1;\r\n            },\r\n            flipPage: function(to) {\r\n                var dataLength;\r\n                if (!this.detailIsOpen) {\r\n                    dataLength = this[nowActiveSection].data.list.length;\r\n                } else {\r\n                    dataLength = this[nowActiveSection + \"Detail\"].data.history.length;\r\n                }\r\n                var maxIndex = Math.ceil(dataLength / this.dynamicLoading.rawCapacity);\r\n                switch (to) {\r\n                    case \"next\":\r\n                        this.dynamicLoading.baseIndex = Math.min((this.dynamicLoading.baseIndex + 1), maxIndex);\r\n                        break;\r\n                    case \"last\":\r\n                        this.dynamicLoading.baseIndex = Math.max((this.dynamicLoading.baseIndex - 1), 1);\r\n                        break;\r\n                }\r\n            },\r\n            searchData: function() {\r\n                var localApp = this;\r\n                var txt = this.search.txt;\r\n                if (txt.length < 1) return;\r\n                var toRequest = \"search?txt=\" + txt;\r\n                if (nowActiveSection === 'index') {\r\n                    toRequest += \"&fields=shop,user,container\"\r\n                } else if (nowActiveSection === 'container') {\r\n                    toRequest += \"&fields=container\"\r\n                } else {\r\n                    return;\r\n                }\r\n                requestData(toRequest, function(data) {\r\n                    showedDetail = \"search\";\r\n                    localApp[showedDetail].show = true;\r\n                    if (!test) localApp[showedDetail].data = data;\r\n                    $('main').scrollTop(0);\r\n                });\r\n            },\r\n            aSearchResultClickListener: function(category, index) {\r\n                var localApp = this;\r\n                var detailToShow = category + \"Detail\";\r\n                var id = this.search.data[category].list[index].id;\r\n                if (id === -1) return;\r\n                var toRequest = detailToShow + \"?id=\" + id;\r\n                requestData(toRequest, function(data) {\r\n                    if (showedDetail) localApp[showedDetail].show = false;\r\n                    localApp[nowActiveSection].show = false;\r\n                    localApp[category].show = true;\r\n                    nowActiveSection = category;\r\n                    tmpDynamicLoadingBaseIndex = null;\r\n                    localApp.dynamicLoading.baseIndex = 1;\r\n                    needUpdate = true;\r\n                    localApp.search.placeholder = (placeholderTxtDict[nowActiveSection] ? \"在「\" + placeholderTxtDict[nowActiveSection] + \"」中搜尋\" : \"搜尋\");\r\n                    localApp[detailToShow].show = true;\r\n                    showedDetail = detailToShow;\r\n                    if (!test) localApp[showedDetail].data = data;\r\n                    cleanSearchBar();\r\n                    $('main').scrollTop(0);\r\n                    if (!test)\r\n                        requestData(category, function(data) {\r\n                            localApp[category].data = data;\r\n                        }, {\r\n                            daemon: true\r\n                        });\r\n                });\r\n            },\r\n            listMatchCtx: function(data) {\r\n                if (this.searchRegExp) {\r\n                    return data.replace(this.searchRegExp, \"<strong>$&</strong>\");\r\n                } else {\r\n                    return data;\r\n                }\r\n            },\r\n            numberToPercentage: numberToPercentage\r\n        },\r\n        computed: {\r\n            detailIsOpen: function() {\r\n                return this.search.show || this.shopDetail.show || this.userDetail.show || this.containerDetail.show || this.deliveryDetail.show;\r\n            },\r\n            searchRegExp: function() {\r\n                if (this.search.txt.length > 0) {\r\n                    this.dynamicLoading.baseIndex = 1;\r\n                    var txtArr = this.search.txt.split(\" \").filter(\r\n                        function(ele) {\r\n                            return ele !== \"\";\r\n                        }\r\n                    );\r\n                    txtArr.forEach(function(ele, index, arr) {\r\n                        if (ele.length > 1)\r\n                            arr[index] = ele.split(\"\").join(\"-*\");\r\n                    });\r\n                    var regExpTxt = txtArr.join(\"|\");\r\n                    try {\r\n                        return new RegExp(regExpTxt, 'gi');\r\n                    } catch (error) {\r\n                        return null;\r\n                    }\r\n                } else {\r\n                    return null;\r\n                }\r\n            },\r\n            shopList: function() {\r\n                return this.shop.data.list.filter(dataFilter);\r\n            },\r\n            userList: function() {\r\n                return this.user.data.list.filter(dataFilter);\r\n            }\r\n        },\r\n        data: {\r\n            loading: {\r\n                show: false,\r\n                txt: \"載入中...\"\r\n            },\r\n            dynamicLoading: {\r\n                baseIndex: 1,\r\n                rawCapacity: 0\r\n            },\r\n            index: {\r\n                show: false,\r\n                data: {\r\n                    summary: {\r\n                        userAmount: 824,\r\n                        storeAmount: 18,\r\n                        activityAmount: 62\r\n                    },\r\n                    activityHistorySummary: {\r\n                        usedAmount: 16774,\r\n                        lostAmount: 135,\r\n                        totalDuration: 12314\r\n                    },\r\n                    shopHistorySummary: {\r\n                        usedAmount: 6487,\r\n                        lostAmount: 248,\r\n                        totalDuration: 57563433659,\r\n                        quantityOfBorrowingFromDiffPlace: 796\r\n                    },\r\n                    shopRecentHistorySummary: {\r\n                        usedAmount: 87,\r\n                        lostAmount: 3,\r\n                        totalDuration: 111013967,\r\n                        quantityOfBorrowingFromDiffPlace: 23\r\n                    }\r\n                }\r\n            },\r\n            search: {\r\n                show: false,\r\n                txt: \"\",\r\n                placeholder: \"搜尋\",\r\n                data: {\r\n                    user: {\r\n                        show: true,\r\n                        list: [{\r\n                            id: \"0936033091\",\r\n                            name: \"0936-033-091\"\r\n                        }]\r\n                    },\r\n                    container: {\r\n                        show: true,\r\n                        list: [{\r\n                            id: 17,\r\n                            name: \"#017　16oz 杯子\",\r\n                            type: 0\r\n                        }]\r\n                    },\r\n                    shop: {\r\n                        show: true,\r\n                        list: [{\r\n                            id: 0,\r\n                            name: \"布萊恩紅茶\"\r\n                        }]\r\n                    },\r\n                    delivery: {\r\n                        show: true,\r\n                        list: []\r\n                    }\r\n                }\r\n            },\r\n            shop: {\r\n                show: false,\r\n                data: {\r\n                    list: [{\r\n                        id: 0,\r\n                        storeName: \"店名\",\r\n                        toUsedAmount: 0,\r\n                        todayAmount: 0,\r\n                        weekAmount: 0,\r\n                        weekAverage: 0\r\n                    }]\r\n                }\r\n            },\r\n            shopDetail: {\r\n                show: false,\r\n                expand: false,\r\n                data: {\r\n                    storeName: \"布萊恩紅茶\",\r\n                    toUsedAmount: 24,\r\n                    todayAmount: 2,\r\n                    weekAmount: 18,\r\n                    recentAmount: 18,\r\n                    joinedDate: 1234,\r\n                    contactNickname: \"店長\",\r\n                    contactPhone: \"0988555666\",\r\n                    recentAmountPercentage: 0.16,\r\n                    weekAverage: 10,\r\n                    history: [{\r\n                        time: 1234,\r\n                        serial: \"#161\",\r\n                        action: \"借出\",\r\n                        owner: \"0911-***-521\",\r\n                        by: \"布萊恩紅茶(阿呆店長)\"\r\n                    }]\r\n                }\r\n            },\r\n            activity: {\r\n                show: false,\r\n\r\n            },\r\n            user: {\r\n                show: false,\r\n                data: {\r\n                    totalUserAmount: 0,\r\n                    totalUsageAmount: 0,\r\n                    weeklyAverageUsage: 0,\r\n                    totalLostAmount: 0,\r\n                    list: [{\r\n                        id: \"\",\r\n                        phone: \"0912-345-678\",\r\n                        usingAmount: 0,\r\n                        lostAmount: 0,\r\n                        totalUsageAmount: 0\r\n                    }]\r\n                }\r\n            },\r\n            userDetail: {\r\n                show: false,\r\n                expand: false,\r\n                data: {\r\n                    userPhone: \"0936-003-091\",\r\n                    usingAmount: 3,\r\n                    lostAmount: 23,\r\n                    totalUsageAmount: 200,\r\n                    joinedDate: 1234,\r\n                    joinedMethod: \"店鋪 (方糖咖啡)\",\r\n                    recentAmount: 18,\r\n                    recentAmountPercentage: 0.16,\r\n                    weekAverage: 10,\r\n                    averageUsingDuration: 20 * 60 * 1000,\r\n                    amountOfBorrowingFromDiffPlace: 43,\r\n                    history: [{\r\n                        containerType: \"12oz 玻璃杯\",\r\n                        containerID: \"#101\",\r\n                        rentTime: 1234,\r\n                        rentPlace: \"布萊恩紅茶\",\r\n                        returnTime: 1234,\r\n                        returnPlace: \"布萊恩紅茶\",\r\n                        usingDuration: 1234\r\n                    }]\r\n                }\r\n            },\r\n            container: {\r\n                show: false,\r\n                data: {\r\n                    list: [{\r\n                        id: 0,\r\n                        type: \"類別\",\r\n                        totalAmount: 0,\r\n                        toUsedAmount: 0,\r\n                        usingAmount: 0,\r\n                        returnedAmount: 0,\r\n                        toCleanAmount: 0,\r\n                        toDeliveryAmount: 0,\r\n                        toSignAmount: 0,\r\n                        inStorageAmount: 0,\r\n                        lostAmount: 0\r\n                    }]\r\n                }\r\n            },\r\n            containerDetail: {\r\n                show: false,\r\n                expand: false,\r\n                data: {\r\n                    containerID: \"#257\",\r\n                    containerType: {\r\n                        txt: \"16oz 玻璃杯\",\r\n                        code: 1\r\n                    },\r\n                    reuseTime: 24,\r\n                    status: \"使用中\",\r\n                    bindedUser: \"0921-**-931\",\r\n                    joinedDate: 1234,\r\n                    history: [{\r\n                        tradeTime: 1234,\r\n                        action: \"借出\",\r\n                        newUser: \"0921-***-931\",\r\n                        oriUser: \"特有種商行(小衛)\",\r\n                        comment: \"\"\r\n                    }]\r\n                }\r\n            },\r\n            delivery: {\r\n                show: false,\r\n\r\n            },\r\n            deliveryDetail: {\r\n                show: false,\r\n                expand: false,\r\n\r\n            }\r\n        }\r\n    });\r\n    window.app = app;\r\n    app.navClickListener(nowActiveSection);\r\n}","(function(window) {\r\n    var pendingReq = null;\r\n\r\n    function requestData(page, cb, option) {\r\n        if (pendingReq) pendingReq.abort();\r\n        if (!option) option = {};\r\n        var daemon = option.daemon || false;\r\n        if (!daemon) startLoading();\r\n        var requestUrl = \"/manager/data/\" + page;\r\n        console.log(requestUrl);\r\n        pendingReq = $.ajax(requestUrl, {\r\n                headers: {\r\n                    Accept: \"application/json; charset=utf-8\"\r\n                },\r\n                dataType: \"json\",\r\n                // timeout: 30 * 1000\r\n            })\r\n            .done(function(data, textStatus, jqXHR) {\r\n                if (!daemon) stopLoading();\r\n                cb(data);\r\n            })\r\n            .fail(function(jqXHR, textStatus, errorThrown) {\r\n                if (!daemon) stopLoading();\r\n                if (jqXHR.statusText !== \"abort\") {\r\n                    if (jqXHR.responseJSON && jqXHR.responseJSON.code === \"B005\")\r\n                        window.location.href = $(\"#logout\").attr('href');\r\n                    else\r\n                        showErr(\"[\" + jqXHR.status + \"]: \" + (jqXHR.responseJSON ? jqXHR.responseJSON.message : jqXHR.statusText || \"Unknown ERR\"));\r\n                }\r\n            })\r\n            .always(function() {\r\n                pendingReq = null;\r\n            });\r\n    }\r\n\r\n    function requestDataDemo(page, cb, option) {\r\n        if (pendingReq) clearTimeout(pendingReq);\r\n        startLoading();\r\n        var requestUrl = \"/manager/data/\" + page;\r\n        console.log(requestUrl);\r\n        pendingReq = setTimeout(function() {\r\n            pendingReq = null;\r\n            stopLoading();\r\n            cb();\r\n        }, 500);\r\n    }\r\n\r\n    function startLoading() {\r\n        app.loading.txt = \"Loading...\";\r\n        app.loading.show = true;\r\n    }\r\n\r\n    function stopLoading() {\r\n        app.loading.show = false;\r\n        app.loading.txt = \"\";\r\n    }\r\n\r\n    function showErr(errMsg) {\r\n        document.querySelector('#toast').MaterialSnackbar.showSnackbar({\r\n            message: errMsg,\r\n            timeout: 4000\r\n        });\r\n    }\r\n\r\n    window.test = false;\r\n    window.requestData = function(page, cb, option) {\r\n        if (!window.test) return requestData(page, cb, option);\r\n        else return requestDataDemo(page, cb, option);\r\n    };\r\n}(window));"]}